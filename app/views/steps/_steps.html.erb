<button id="btn-modifier" onclick="displayModificationOnClick()">Modifier</button>
<% @steps.each_with_index do |step, index| %>
  <div class="step-card">
    <div class="step-card-parts">
      <% if step.photo.blank? %>
        <div class="step-card-photo step-card-part" style="background-color: #5C6B73">
      <% else %>
        <div class="step-card-photo step-card-part" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.2)),
             url('<%= cl_image_path step.photo, height: 300, width: 400, crop: :fill %>')">
      <% end %>
          <div class="step-card-title">
            <h3> <%= index + 1 %> : <%= step.address %></h3>
            <div class="dates text-center">
              <i class="fas fa-calendar"></i> <%= step.date_begin.strftime("%-d %b %y") %> -
              <%= step.date_end.strftime("%-d %b %y") %>  (<%= (step.date_end - step.date_begin).to_i %> nuits)
            </div>
            <br>
            <div class="step-card-links links">
              <%= link_to step_path(step),  method: :delete, data: { confirm: "Are you sure?" } do %>
                <i class="far fa-trash-alt"></i>
              <% end %>
              <%= link_to '<i class="fas fa-pencil-alt"></i>'.html_safe, edit_step_path(step) %>
            </div>
          </div>
        </div>


  <!-- ONGLETS -->
      <div class="step-card-reco step-card-part" id="reco_item_<%= step.id %>">
        <div class="step-card-reco-item reco-avatar" onclick="displayCommentContent(<%= step.id %>)">
          <i class="fas fa-comment"></i>
        </div>
        <div class="step-card-reco-item reco-avatar" onclick="displayHotelContent(<%= step.id %>)">
          <i class="fas fa-bed"></i>
        </div>
        <div class="step-card-reco-item reco-avatar">
          <i class="fas fa-utensils"></i>
        </div>
        <div class="step-card-reco-item reco-avatar">
          <i class="fas fa-glass-martini"></i>
        </div>
        <div class="step-card-reco-item reco-avatar">
          <i class="fas fa-walking"></i>
        </div>
      </div>

      <div class="step-card-reco step-card-part hidden" id="reco_content_<%= step.id %>">

        <div id="comment_<%= step.id %>" class="step-card-reco-content hidden">
          <div class="close" id="comment_close_<%= step.id %>" onclick="closeCommentOnClick(<%= step.id %>)" >
            <i class="fas fa-times-circle"></i>
          </div>
          <h3>Description de l'étape</h3></br>
          <p> <%= step.comment %> </p>
        </div>

        <div id="hotel_<%= step.id %>" class="step-card-reco-content hidden">
          <div class="close" id="hotel_close_<%= step.id %>" onclick="closeHotelOnClick(<%= step.id %>)" >
            <i class="fas fa-times-circle"></i>
          </div>
          <h3>Hébergements</h3></br>
          <ul>
            <%@hotels.where(step_id: step.id).each do |hotel| %>
              <li>
                <% if hotel.love_tag == true %><i class="fas fa-heart love-tag"></i><% end %>
                <%= hotel.address %> <%= hotel.price %>  </br> <%= hotel.name.capitalize %>
                <div class="links">
                <%= link_to '<i class="fas fa-pencil-alt"></i>'.html_safe, edit_hotel_path(hotel) %>
                <%= link_to hotel_path(hotel.id),  method: :delete, data: { confirm: "Are you sure?" } do %>
                  <i class="far fa-trash-alt"></i>
                <% end %>
                </div>
              </li>
            <% end %>
          </ul>
        </div>

        <div id="resto-content" class="step-card-reco-content hidden"></div>
        <div id="bar-content" class="step-card-reco-content hidden"></div>
        <div id="activity-content" class="step-card-reco-content hidden"></div>

      </div>
      <!-- CONTENU des ONGLETS -->
  </div>
  <div class="step-card-parts hidden">

  </div>

  </div>
<% end %>



<script>
  function displayCommentContent(id) {
    const recoItems = document.getElementById(`reco_item_${id}`);
    const recoContent = document.getElementById(`reco_content_${id}`);
    const element = document.getElementById(`comment_${id}`);
    recoContent.classList.remove("hidden");
    recoItems.classList.add("hidden");
    element.classList.remove("hidden");
  }

 function displayHotelContent(id) {
    const recoItems = document.getElementById(`reco_item_${id}`);
    const recoContent = document.getElementById(`reco_content_${id}`);
    const element = document.getElementById(`hotel_${id}`);
    recoContent.classList.remove("hidden");
    recoItems.classList.add("hidden");
    element.classList.remove("hidden");
  }
  function closeCommentOnClick(id) {
    const close = document.getElementById(`comment_close_${id}`);
    const recoItems = document.getElementById(`reco_item_${id}`);
    const recoContent = document.getElementById(`reco_content_${id}`);
    const element = document.getElementById(`comment_${id}`);
    recoContent.classList.add("hidden");
    recoItems.classList.remove("hidden");
    element.classList.add("hidden");
  }
  function closeHotelOnClick(id) {
    const close = document.getElementById(`hotel_close_${id}`);
    const recoItems = document.getElementById(`reco_item_${id}`);
    const recoContent = document.getElementById(`reco_content_${id}`);
    const element = document.getElementById(`hotel_${id}`);
    recoContent.classList.add("hidden");
    recoItems.classList.remove("hidden");
    element.classList.add("hidden");
  }

  function displayModificationOnClick() {
    // const btn = document.getElementById("btn-modifier");
    const links = document.querySelectorAll('.links');
    // btn.addEventListener('click', () => {
      links.forEach((link) => {link.classList.toggle('hidden')});
    // });
  }
</script>
